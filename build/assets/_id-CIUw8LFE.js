import{e as p,f as j,i as k,b as N,c as w,r as d,j as e,k as E,l as C}from"./index-BZ6FMMt2.js";import{f as S}from"./balanceCalculations-BwgctEfh.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],L=p("Upload",D);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],A=p("X",F),U=()=>{const m=j(),{id:i}=k({strict:!1}),u=N(),{events:b}=w(t=>t.events),[x,g]=d.useState(null),[h,o]=d.useState(""),l=!!(i&&i!=="new"),s=l?b.find(t=>t.id===i):null,[r,n]=d.useState({name:"",description:"",amount:0,date:"",type:"ingreso",attachment:""});d.useEffect(()=>{s&&(n({name:s.name,description:s.description||"",amount:s.amount,date:new Date(s.date).toISOString().slice(0,16),type:s.type,attachment:s.attachment||""}),s.attachment&&o(s.attachment))},[s]);const y=async t=>{t.preventDefault();try{if(console.log("Formulario enviado con valores:",r),!r.name.trim()){alert("El nombre es obligatorio");return}if(r.name.length>20){alert("El nombre debe tener máximo 20 caracteres");return}if(r.description&&r.description.length>100){alert("La descripción debe tener máximo 100 caracteres");return}if(r.amount<=0){alert("La cantidad debe ser un número positivo");return}if(!r.date){alert("La fecha es obligatoria");return}let a=r.attachment;x&&(a=await S(x));const c={...r,date:new Date(r.date).toISOString(),attachment:a};console.log("Datos del evento a enviar:",c),l&&s?(console.log("Actualizando evento:",s.id),await u(E({...c,id:s.id}))):(console.log("Creando nuevo evento"),await u(C(c))),console.log("Navegando a la página principal"),m({to:"/"})}catch(a){console.error("Error saving event:",a),alert("Error al guardar el evento: "+a)}},v=t=>{if(g(t),t){const a=URL.createObjectURL(t);o(a)}else o((s==null?void 0:s.attachment)||"")},f=()=>{g(null),o(""),n(t=>({...t,attachment:""}))};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:e.jsx("div",{className:"container mx-auto px-4 max-w-2xl",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:l?"Editar Evento":"Nuevo Evento"}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Nombre del evento ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:t=>n(a=>({...a,name:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Ingrese el nombre del evento",maxLength:20,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.name.length,"/20 caracteres"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Descripción"}),e.jsx("textarea",{value:r.description,onChange:t=>n(a=>({...a,description:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Descripción opcional del evento",rows:3,maxLength:100}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.description.length,"/100 caracteres"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Fecha y hora ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"datetime-local",value:r.date,onChange:t=>n(a=>({...a,date:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Cantidad ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:r.amount,onChange:t=>n(a=>({...a,amount:Number(t.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"0.00",min:"0",step:"0.01",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Tipo de evento ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.type,onChange:t=>n(a=>({...a,type:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"ingreso",children:"Ingreso"}),e.jsx("option",{value:"egreso",children:"Egreso"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adjunto (opcional)"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4",children:h?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Vista previa",className:"max-w-full h-48 object-cover rounded-lg mx-auto"}),e.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 shadow-lg",children:e.jsx(A,{size:16})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(L,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900 dark:text-white",children:"Seleccionar archivo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{var a;return v(((a=t.target.files)==null?void 0:a[0])||null)},className:"sr-only"})]})})]})})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>m({to:"/"}),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:[l?"Actualizar":"Crear"," Evento"]})]})]})]})})})},_=()=>e.jsx(U,{});export{_ as component};
